# התקפות האמפירית של מודלים פיננסיים

**מבחן GRS (Gibbons, Ross, and Shanken, 1989)**: זהו כלי סטטיסטי, או מבחן אמפירי, שפיתחו שלושה חוקרים. המטרה של המבחן היא לבדוק האם המודלים שהזכרנו (כמו CAPM ו-APT) אכן עובדים בפועל. 

במילים אחרות, הוא בודק האם המודל, שהוא תיאוריה על הנייר, אכן מצליח לתאר ולחזות באופן מדויק את המציאות הכלכלית. המבחן עושה זאת על ידי השוואה בין שני נתונים:

1. **התחזיות של המודל:** מה המודל צופה שיהיה הקשר בין סיכון לתשואה, בהתבסס על הנחותיו.
    
2. **הנתונים בפועל:** מה הקשר האמיתי שנמדד בשוק ההון לאורך זמן.
    
מבחן GRS מספק כלי סטטיסטי שמאפשר לקבוע האם ההבדלים בין התחזיות של המודל לבין המציאות הם משמעותיים. אם המבחן מראה שיש פערים גדולים ומשמעותיים, ניתן להסיק שהמודל אינו תקף מבחינה אמפירית, כלומר, הוא אינו מתאר את המציאות בצורה מספקת.

כלי GRS הוא **כלי בדיקה שנועד להעריך את האיכות והאמינות של המודלים הפיננסיים עצמם**. הוא מהווה חלק חשוב בתהליך המדעי שבו בודקים האם תיאוריות כלכליות מחזיקות מים גם כשהן נבחנות מול נתוני אמת מהשוק.

### הרעיון המרכזי

המבחן בוחן האם **אלפא** (α) של כל תיקי הבדיקה (Test Portfolios) במודל רגרסיה מול גורמים מסבירים (כמו השוק ב-CAPM או גורמים נוספים ב-APT) שווה אפס באופן מובהק סטטיסטית.

במילים אחרות:

> אם המודל נכון, אז אין החזר עודף (אלפא) שניתן להסביר מעבר לגורמים שבמודל.


### הנוסחה הכללית של מבחן GRS:

$$
GRS = \frac{(T/N) \cdot (T - N - K)}{T - K - 1} \cdot \frac{\hat{\alpha}' \hat{\Sigma}^{-1} \hat{\alpha}}{1 + \bar{f}' \hat{\Sigma}_f^{-1} \bar{f}}

$$
כאשר:

- **$T$** = מספר התקופות (תצפיות בזמן)
    
- $N$ = מספר תיקי הבדיקה
    
- $K$ = מספר הגורמים במודל (למשל: CAPM → K=1)
    
- **$α^\hat{\alpha}$ = וקטור האלפות המוערכות מרגרסיות time-series של כל התיקים מול הגורמים
    
- $\hat{\Sigma}$ = מטריצת השונויות/קובאריאציות של שאריות הרגרסיה
    
- $\bar{f}$ = ממוצע פרמיות הסיכון של הגורמים
    
* $f\hat{\Sigma}_f$ = מטריצת השונויות/קובאריאציות של פרמיות הסיכון
    

המבחן מתפלג לפי **$F$** עם דרגות חופש (N,T−N−K)(N, T-N-K).


### פרשנות:

- $H₀$: כל האלפות שוות לאפס (המודל מסביר את כל התשואות הממוצעות).
    
- $H₁$: לפחות אלפא אחת אינה אפס → המודל נדחה.
    

אם ערך ה- p נמוך (p<0.05) → דוחים את המודל.  
בפועל, במחקרים אמפיריים רבים ה- GRS דוחה את ה- CAPM, דבר שמחזק את הצורך במודלים מרובי גורמים.

### יישום פרקטי:

- מחושב לרוב לאחר הרצת רגרסיות Time-Series של תשואות התיקים מול הגורמים (OLS).
    
- מיושם גם במבחן של מודלים מרובי גורמים כמו **Fama-French 3/5 factors**.
    
- שימושי במיוחד כדי להשוות בין מודלים: אם מודל אחד עובר את מבחן GRS ואחר לא, זה עדות לאיכות טובה יותר של המודל שעבר.
    


## הסבר פשוט  

### מה בעצם בודקים?

המבחן בודק אם **המודל הפיננסי שבחרת (למשל CAPM או מודל עם כמה גורמים)** מצליח להסביר את התשואות של קבוצת תיקי השקעה.

אם המודל טוב – **לא יישאר "עודף תשואה" לא מוסבר** (כלומר, האלפא של כל תיק תהיה שווה לאפס).  
אם המודל לא מספיק טוב – יהיו תיקים עם **אלפא שונה מאפס**, כלומר התשואות שלהן לא מוסברות ע"י המודל.

---

### איך זה עובד בפועל?

1. לוקחים מספר תיקים (N) ומחשבים את התשואות שלהם לאורך זמן (T תקופות).
    
2. מריצים לכל תיק רגרסיה מול הגורמים במודל (למשל: השוק ב- CAPM).
    
3. בודקים את **האלפא** של כל תיק – האלפא מייצגת את התשואה "העודפת" שלא מוסברת ע"י המודל.
    
4. המבחן שואל:
    
    > "האם כל האלפות הללו הן בעצם 0, או שלפחות אחת מהן שונה מאפס בצורה מובהקת?"
    

---

### פרשנות פשוטה:

- **אם האלפות ≈ 0** → המודל מצליח להסביר את התשואות (מקבלים ערך p גבוה, לא דוחים את המודל).
    
- **אם יש אלפות שונות מאפס** → המודל לא מספיק טוב (ערך p נמוך, דוחים את המודל).
    

---

### דוגמה יומיומית:

נניח שאתה בוחן דיאטה חדשה. אם כל מי שניסה אותה ירד בדיוק במשקל כפי שציפית – הדיאטה "עובדת לפי המודל".  
אבל אם חלק ירדו הרבה יותר או לא ירדו בכלל – סימן שהדיאטה לא מסבירה את התוצאות.  
אותו דבר כאן – האלפא היא כמו "שאריות" שלא הוסברו.

---

### למה זה חשוב?

המבחן נותן **בדיקה סטטיסטית רשמית** למודלים כמו CAPM או Fama-French:

- אם המודל עובר את המבחן → אפשר לומר שהוא מתאים לנתונים.
    
- אם לא → צריך לחפש מודל טוב יותר עם עוד גורמים (כמו גודל חברה, Value וכו').
    

---

רוצה שאעשה לך **דוגמה מספרית פשוטה עם 3 תיקים** (כולל חישוב ידני של GRS) כדי שתראה איך זה עובד בפועל?

---

רוצה שאדגים לך **חישוב מספרי מלא** (כולל קוד ב- Python שמחשב את סטטיסטיקת ה- GRS על נתוני CAPM)?


``` py

import numpy as np
import pandas as pd
from scipy.stats import f

# נתוני הדוגמה
T = 60  # 60 חודשים (5 שנים)
N = 3   # 3 תיקים
K = 1   # מודל CAPM עם גורם שוק אחד

# אלפות (תשואות עודפות שלא מוסברות) בשלושה תיקים
alpha = np.array([0.002, 0.0015, -0.0005])  # בערכים חודשיים (0.2%, 0.15%, -0.05%)

# מטריצת שונויות/קובאריאציות של השאריות (3x3)
Sigma = np.array([
    [0.0004, 0.0001, 0.00005],
    [0.0001, 0.0003, 0.00002],
    [0.00005, 0.00002, 0.00025]
])

# ממוצע פרמיית הסיכון של הגורם (למשל תשואת שוק פחות ריבית חסרת סיכון)
f_bar = np.array([0.005])  # 0.5% לחודש

# שונויות/קובאריאציות של פרמיות הסיכון (ב-CAPM זו סקלרית)
Sigma_f = np.array([[0.002]])

# חישוב הסטטיסטיקה של GRS
alpha_matrix = alpha.reshape(-1, 1)
Sigma_inv = np.linalg.inv(Sigma)
f_part = (1 + (f_bar @ np.linalg.inv(Sigma_f) @ f_bar.T)).item()

GRS_stat = ((T/N) * (T - N - K) / (T - K - 1)) * ((alpha_matrix.T @ Sigma_inv @ alpha_matrix).item() / f_part)

# ערך p (התפלגות F עם דרגות חופש N ו-(T-N-K))
p_value = 1 - f.cdf(GRS_stat, N, T - N - K)

GRS_stat, p_value

```

``` {python}

Result
(0.3073829515502296, 0.8199384454887297)
```

בדוגמה הזו קיבלנו:

- **סטטיסטיקת GRS = 0.307**
    
- **ערך p ≈ 0.82**
    

### פרשנות:

- ערך ה- p גבוה מאוד (**0.82 > 0.05**) → **לא דוחים את השערת האפס**.
    
- כלומר: אין עדות לכך שהאלפות שונות מאפס → המודל (במקרה זה CAPM) מצליח להסביר את התשואות של שלושת התיקים הללו.
    

### אם האלפות היו גדולות יותר:

נניח אלפות של **[0.01, 0.008, 0.005]** (1%, 0.8%, 0.5% לחודש), הסטטיסטיקה הייתה עולה משמעותית וה- p-value היה קטן, מה שהיה מוביל לדחיית המודל.


## כלים נוספים

הנה כמה מבחנים ושיטות נוספות שפותחו כדי להתמודד עם בעיות מדידה דומות:

---

## **מבחן Wald / Likelihood Ratio / Lagrange Multiplier**

- אלו מבחנים כלליים בכלכלה אמפירית שנועדו לבדוק **אילוצים פרמטריים במודלים רגרסיביים**.
    
- לדוגמה: לבדוק האם כל האלפות שוות לאפס (בדומה ל-GRS) או האם פרמטרים מסוימים שווים ביניהם.
    
- שימושים במימון: בדיקת התאמה של מודלים פקטוריאליים (APT) או מגבלות על פרמטרי סיכון.
    

---

##  **מבחני Time-Series לרגרסיות גורמים**

- במקום לבדוק את כל האלפות יחד (כמו GRS), בודקים כל תיק בנפרד:
    
    - **t-test** על אלפא לכל תיק: האם שונה מאפס?
        
    - בעיה: אם בודקים הרבה תיקים, יש בעיה של **מבחנים מרובים** (Multiple Testing) והטיות במדגם.
        

---

##  **Cross-Sectional Regressions (Fama-MacBeth, 1973)**

- במקום לבחון כל תיק לאורך זמן (time-series), בודקים את **הקשר החוצי (cross-section)** בין בטא לגורם לבין תשואה ממוצעת.
    
- **אם המודל נכון:** תיק עם בטא גבוהה לשוק אמור להניב תשואה צפויה גבוהה יותר.
    
- נחשב בשני שלבים:
    
    1. שלב ראשון: מחשבים בטות לכל נכס (time-series regression).
        
    2. שלב שני: מריצים בכל חודש רגרסיית cross-section של תשואה על בטא, וממוצעים את התוצאות.
        

בעיה: מתבסס על הנחה של **אי- מתאם בין השאריות לבין הגורמים**, שעלולה לא להחזיק בפועל.



##  **Michaelsen (1997) Test / Shanken Correction**

- נוגע לבעיית **טעויות מדידה בבטות** (Errors-in-Variables):
    
    - כשאומדים בטא על סמך מדגם סופי, יש רעש במדידה.
        
    - Shanken (1992) הציע תיקון לסטיות התקן של מקדמים ב- Fama-MacBeth כדי לקחת זאת בחשבון.
        



##  **מבחני סלקציה ותיקים ממיונים (Portfolio Sorts)**

- במקום מבחנים סטטיסטיים "טהורים", חוקרים בונים **תיקי מיון** (sorted portfolios) על פי גורם מסוים (כמו גודל חברה או Book-to-Market), ובודקים אם נוצר **spread** בין התיקים.
    
- שיטה אמפירית נפוצה מאוד – לדוגמה, במודל Fama-French: בונים 25 תיקים על בסיס גודל ו- B/M ובוחנים אם הגורמים מסבירים אותם.
    



##  **מבחני Hansen-Jagannathan (HJ Bound, 1997)**

- בוחן אם ה"מחיר של הסיכון" שמודל מסוים מייצר **תואם את מגבלות השוק**.
    
- מבחן זה אינו בודק ישירות אלפות, אלא בודק האם **Stochastic Discount Factor (SDF)** שמתקבל מהמודל מתאים לנתוני התשואות.
    
- אם המודל נכשל במבחן הזה, הוא לא יכול להיות עקבי עם אף שוק ללא ארביטראז'.
    


##  **MSE של Pricing Errors (או מבחן RMSPE)**

- גישה אלטרנטיבית למבחני השערות:
    
    - מודדים את השגיאות במחירי הנכסים שהמודל "מנבא".
        
    - משווים RMSPE (Root Mean Squared Pricing Error) בין מודלים שונים.
        


##  **Bootstrap ו-Bayesian Model Comparison**

- שיטות סימולציה (Bootstrap) או בייסיאניות להשוואת מודלים, שמטרתן להתמודד עם מגבלות מדגם קטן ותלות מבנית בין תיקים.
    
- בשנים האחרונות הופכות לפופולריות במחקרים אמפיריים במימון.
    


### **למה כל כך הרבה מבחנים?**

הבעיה המרכזית היא שמודלים כמו CAPM מניחים הנחות חזקות (משקיע רציונלי, שוק משוכלל, מדידת בטות מדויקת וכו'). בפועל:

- יש רעש בנתונים (Sampling Error).
    
- יש טעויות מדידה בפרמטרים.
    
- יש סיכון ספציפי שלא נעלם גם בתיקים רחבים.
    

לכן פותחו מבחנים שונים כדי להתמודד עם סוגי הטיות שונים.